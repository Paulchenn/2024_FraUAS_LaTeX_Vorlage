 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Template fuer Abschlussarbeiten von Studierenden der  Frankfurt University of Applied Sciences
% 
% erstellt von: Prof. Dr.-Ing. Thomas Hollstein
% 
% Last revision: 22.06.2023
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Grundlegende Formatierungen
\documentclass[
	%twoside, 
	%openright,
	titlepage,
	numbers=noenddot,
	headinclude,
	%1headlines,
	footinclude=true,
	%cleardoublepage=empty,
	%BCOR=5mm,
	fontsize=12pt,%11pt,
	paper=a4paper,
	%letterpaper
	ngerman,
	american,
	%table
 ]
% Dokumententyp: (legt grundlegende Formatierrichtlinien fest)
%{report}
{scrreprt}
%{book}

% Farbigen Text
\usepackage{xcolor}
\usepackage{colortbl}

\parindent = 10pt  % Neue Absaetze nicht einrueckenn
\parskip = 1ex % Neue Absaetze: 1/2 Zeile Abstand


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%% zu nutzende Pakete einbinden: %%%%%%%%%%

%%%%% Package Kommentare:
\usepackage{comment}
\usepackage[colorinlistoftodos]{todonotes}
\newcommand{\mycomment}[1]{\todo[inline,linecolor=green,backgroundcolor=yellow!25,bordercolor=green,caption={}]{todo: #1}}

%%%%% package Sprachunterstuetzung:
\usepackage[utf8]{inputenc} % Eingabekodierung auf UTF-8 setzen
\usepackage[T1]{fontenc}    % Schriftkodierung auf T1 setzen
\usepackage[ngerman]{babel}
\usepackage{csquotes}

%%%%% Package Multirow ermoeglicht, dass sich ein Kaestchen in einer Tabelle ueber mehrere Zeilen erstrecken kann:
\usepackage{multirow}
\usepackage{array}
\usepackage{ragged2e}
\usepackage{booktabs}
\usepackage{arydshln}
% Beispiele unter: https://texblog.org/2012/12/21/multi-column-and-multi-row-cells-in-latex-tables/
%Vereinigung von Feldern in Tabellen:
%\multicolumn{number cols}{align}{text} % align: l,c,r
%\multirow{number rows}{width}{text}

%%%% Serifenloser Textstil fuer das ganze Dokument: 
\RequirePackage[sfdefault,lf]{carlito}
\usepackage{lmodern}
% \RequirePackage[T1]{fontenc}
% to imitate Calibri:
\renewcommand*\familydefault{\sfdefault} %% Base font of the document is to be sans serif
\usepackage{lipsum}

%%%%%% Grafiken einbinden
\usepackage{float}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{lscape}
\usepackage{svg}
\usepackage{pgf-pie}
\usepackage{transparent}
\usepackage{pdfpages}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{plot coordinates/math parser=false}
\usetikzlibrary{patterns,arrows,shapes,positioning,shadows,trees,calc,positioning,external}
\usepackage{tikz}
\tikzexternalize[prefix=Figures/tikzexternalize_cache/,optimize command away=\includepdf]
%\tikzexternaldisable
% https://golatex.de//wiki/%5cincludegraphics

%%%%%% Fuer Baumdiagramme
\tikzset{
	basic/.style  = {draw, rectangle},
	root/.style   = {basic, rounded corners=2pt, thin, align=center},
	level 2/.style = {basic, rounded corners=6pt, thin,align=center, text width=5em},
	level 3/.style = {basic, align=left, draw=none, text width=60}
}

%%%%%% Mathematik-Paket AMSMath:
\usepackage[fleqn,reqno]{amsmath}
\usepackage{mathtools}
%%%%%% Brueche
\usepackage{nicefrac} % For comparison
\usepackage{xfrac}    % Works better with other fonts
\usepackage{romannum}

%%%%%%%%%% Seitengeometrie einstellen: %%%%%%%%%%
% https://tex.stackexchange.com/questions/344241/logo-as-header-using-fancyhdr-package
\usepackage{geometry}
\geometry{verbose,
	bmargin=2cm,
	lmargin=2.8cm,
	rmargin=3.5cm
	%footskip=-25pt
}

%%%%%% die Höhe des Top-Margin errechnen:
\newlength\mytopmargin
\newsavebox{\headbox}\savebox{\headbox}{
	%\includegraphics[width=0.3\textwidth]{Figures/xxx.png} \hfill
	\raisebox{-1ex}{\includegraphics[width=0.1\textwidth]{Figures/pdf/FraUas_Logo.pdf}}
}    
\setlength{\mytopmargin}{\totalheightof{\usebox{\headbox}}+2cm}
\geometry{verbose,
	tmargin=\mytopmargin,
	headheight=1.1\mytopmargin,
	footskip=6ex
}

% Flexiblere Tabellen
\usepackage{tabularx}
% \usepackage{xltabular}
\def\tabularxcolumn#1{m{#1}}
\usepackage{enumitem}
%\usepackage{enumerate}
\usepackage{layouts}
\usepackage{listliketab}
\usepackage{rotating} 

% Boxen für Lickert Skalen
\usepackage{wasysym}
\newcommand\insq[1]{%
	\Square\ #1\quad%
}

% Durchstreichen von Text
\usepackage[normalem]{ulem} % mit \sout

%%%%%% Gesamtseitenzahl verwenden:
\usepackage{totpages}

%%%%%% Kalkulationen:
%https://tex.stackexchange.com/questions/30081/how-can-i-sum-two-values-and-store-the-result-in-other-variable
\usepackage{tikz}
\usetikzlibrary{math}
\usepackage{amsmath}
\usepackage{amssymb}

%%%%%% Gestaltung von Kopf- und Fusszeilen:
% https://tex.stackexchange.com/questions/344241/logo-as-header-using-fancyhdr-package
\usepackage{fancyhdr}
\pagestyle{fancy}  % Eigener Seitenstil
\fancyhf{}         % Alle Kopf- und Fußzeilenfelder bereinigen
%\fancyhead[L]{} % Kopfzeile links
\fancyhead[l]{\leftmark
	%\makebox[0.3\textwidth]{\includegraphics[width=0.3\textwidth]{Figures/xxx.png}}
}  
%\fancyhead[c]{\hspace*{0.15\textwidth}\rightmark}
%\fancyhead[C]{\usebox\headbox}                        % Zentrierte Kopfzeile
\fancyhead[R]{
	\makebox[0.2\textwidth]{\raisebox{-5ex}{\hspace*{9.5ex}\includegraphics[width=0.1\textwidth]{Figures/pdf/FraUas_Logo.pdf}}}
}  % Kopfzeile rechts
\renewcommand{\headrulewidth}{0.4pt} % Obere Trennlinie
%\fancyfoot[L]{\today}
\fancyfoot[C]{\ThesisTitleShort} 
%\fancyfoot[R]{Seite \thepage ~von \ref{TotPages}}  % Seitennummer
\fancyfoot[R]{\thepage} % Seitennummer 
\renewcommand{\footrulewidth}{0.4pt} % Untere Trennlinie
\setlength{\mytopmargin}{\totalheightof{\usebox\headbox} +2cm}
%Unterschied zwischen geraden/ungeraden Seiten:
%\fancyhead[OR]{} % "O" steht für "odd", also ungerade Seiten
%\fancyhead[ER]{} % "E" für "even", also gerade Seiten.

%%%%% Erweiterte Formate für Listen/Aufzaehlungen:
\usepackage{paralist}
%Default-Items fuer die vier moeglichen Verschachtelungsebenen:
\setdefaultitem{}{\textbullet}{$\star$}{}

%%%%% FRA-UAS CI Farben:
%\definecolor{airforceblue}{rgb}{0.36, 0.54, 0.66}
% CI-Farben FRA-UAS (blau):
\definecolor{FRAUAS_Blue_Dark}{RGB}{45, 137, 204}
\definecolor{FRAUAS_Blue_Light}{RGB}{182, 210, 228}
% CI-Farben FRA-UAS: FB1
\definecolor{FRAUAS_FB1_Dark}{RGB}{124, 128, 52}
\definecolor{FRAUAS_FB1_Light}{RGB}{213, 213, 179}
% CI-Farben FRA-UAS: FB2
\definecolor{FRAUAS_FB2_Dark}{RGB}{255, 158, 27}
\definecolor{FRAUAS_FB2_Light}{RGB}{251, 221, 173}
% CI-Farben FRA-UAS: FB3
\definecolor{FRAUAS_FB3_Dark}{RGB}{196, 213, 42}
\definecolor{FRAUAS_FB3_Light}{RGB}{237, 240, 166}
% CI-Farben FRA-UAS: FB4
\definecolor{FRAUAS_FB4_Dark}{RGB}{204, 31, 47}
\definecolor{FRAUAS_FB4_Light}{RGB}{240, 166, 183}

%%%%% Sektionstitel nach CI-Farben einfärben:
\usepackage{titlesec}
\titleformat{\section}
{\color{blue50}\normalfont\Large\bfseries} %Titel
{\color{blue50}\thesection}{1em}{}
%{\color{FRAUAS_Blue_Dark}\normalfont\Large\bfseries} %Titel
%{\color{FRAUAS_Blue_Dark}\thesection}{1em}{}
\titleformat{\subsection}
{\color{blue50}\normalfont\large\bfseries} %Titel
{\color{blue50}\thesubsection}{1em}{}
%{\color{FRAUAS_Blue_Dark}\normalfont\large\bfseries} %Titel
%{\color{FRAUAS_Blue_Dark}\thesubsection}{1em}{}
\titleformat{\subsubsection}
{\color{black}\normalfont\bfseries} %Titel
{\color{black}\thesubsection}{0.5em}{}

%\usepackage{appendix}

%%%%% Erweiterte Bibliographie-Stile:
%\usepackage{harvard}
% Title Page
% (wir generieren den Titel per Handlayout und verwenden
% daher die folgenden Befehle nicht)
%\title{}
%\author{}

% https://www.overleaf.com/learn/latex/Hyperlinks
\usepackage{hyperref}
\hypersetup{
	%hyperindex=true,
	%linktocpage=true, % Seitenzahl statt Titel verlinkt
	colorlinks=true,
	linkcolor=black,
	filecolor=black,      
	urlcolor=black,
	pdftitle={Thesis},
	citecolor=black,
	pdfpagemode=UseNone, % Keine automatische Ansichtseinstellung
	pdfstartpage=1,      % Startet auf der ersten Seite
	pdfstartview=Fit     % Zeigt die gesamte Seite im Fenster
}

%\usepackage[hyphens]{url}  %% stellt \url{} zur Verfuegung

%%%%% modernes BibLaTeX mit biber %%%%%
% https://golatex.de/viewtopic.php?t=13917
%\usepackage[style=ieee-alphabetic,backend=biber, natbib=true]{biblatex}

% Literatur nach Erscheinen im Text sortiert
%\usepackage[sorting=none, style=numeric,backend=biber, natbib=true]{biblatex}
%\usepackage[style=apa, backend=biber, natbib=true, sorting=nyt, sortcites=false]{biblatex}
\usepackage[style=ieee, backend=biber, sorting=none, natbib=true]{biblatex}
%\usepackage[style=numeric, backend=biber, natbib=true, sorting=nyt, sortcites=false]{biblatex}
% Ohne eingestellte Sortierung
%\usepackage[ style=numeric,
%backend=biber, natbib=true]{biblatex}

\addbibresource{bibliography.bib}

% Immer shortautor anzeigen, falls vorhanden
\makeatletter
\def\cbx@apa@ifnamesaved{\@firstoftwo}
\makeatother

% Zeilenabstand für das ganze Dokument (1.0 = Normalwert):
\renewcommand{\baselinestretch}{1.0}

%%%%% Acronymdefinitionen einbinden:
\usepackage[printonlyused]{acronym}
\usepackage{tocloft}
%\input{TeXFiles/005_Acronyms}

%%%%% Glossar einbinden
\usepackage{glossaries}
\input{TeXFiles/005_Glossar.tex}
%\usepackage[record]{bib2gls}
%\addbibresource{Glossar.bib}

\setcounter{tocdepth}{1} % Inhaltsverzeichnis bis zur 2. Nummerierungstiefe


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% hier beginnt das eigentliche Dokument 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
	%%%%% Settings einbinden:
	\input{TeXFiles/000_Settings}
	\sloppy %Formatierungsueberstaende am Zeilenende vermeiden
	% https://latexref.xyz/_005cfussy-_0026-_005csloppy.html

	\frenchspacing  
	%Ein Leerzeichen nach Satzende
	%https://texwelt.de/fragen/1154/was-ist-french-spacing-was-macht-frenchspacing

	%\raggedbottom   
	%Standard is \flushbottom, dass heisst alle Seiten werden so gedehnt, dass sie  gleich hoch sind 
	%Schaltet man \raggedbottom ein, ist dies nicht so

	\ifdefined\ThesisLanguageIsEnglish
		\selectlanguage{american}
	\else
		\selectlanguage{ngerman} % ngerman, american
	\fi
	%Deutsch nach neuer Rechtschreibung als Standardsprache fuer das Dokument einstellen

	%\renewcommand*{\bibname}{new name}
	%\setbibpreamble{}

	% Numerierungstiefe setzen:
	% 2: bis subsection (Standard)
	% 3: bis subsubsection
	\setcounter{secnumdepth}{2} %setzt die Numerierungstiefe



	%\renewcommand{\thepage}{\Roman{page}}
	\pagestyle{plain} % Seite ohne Kopf- und Fusszeilen darstellen



	% hier wird die Titelseite eingebunden:
	\input{TeXFiles/001_Titlepage}
	\input{TeXFiles/002_NDNotice}
	\newpage

	% da wir den Titel haendisch erstellt haben entfaellt der folgende Befehl:
	%\maketitle

	%\clearpage

	%\pagestyle{headings} 
	\pagestyle{fancy}   % Seite mit Kopf- und Fusszeilen darstellen
	\pagenumbering{roman}  % Umschalten auf Seitenzahlen in römischer Darstellung
	%\fancyfoot[R]{i}  % Seitennummer roemisch 1, hier per Hand eingetragen, weil es anders nicht funktioniert hat - hat sich erledigt


	\tableofcontents
	\newpage
	\listoffigures
	\newpage
	\listoftables
	
	\ifdefined\ThesisLanguageIsEnglish
		\printglossary[title=Glossary, toctitle=Glossary]
	\else
	%		\printglossary[title=Glossar, toctitle=Glossar]
		\printglossaries
	\fi
	
	\input{TeXFiles/004_Acronyms}
	
	\clearpage
	\pagenumbering{arabic}  % Umschalten auf Seitenzahlen in arabischer Darstellung
	%%%%% Einbinden der Dateien für die einzelnen Sektionen:
	% Verwendet man hier \include statt \input, beginnen neue Sektionen immer auf einer neuen Seite
	%\input{TeXFiles/Abstract}

	\fancyfoot[R]{\thepage}  % Seitennummer


	%\myName
	\input{TeXFiles/010_Kurzfassung}
	%\input{TeXFiles/004_LaTeXHowTo}      %%%%%% <<<<<< nach dem ersten Ansehen, bitte diese Zeile auskommentieren
	\input{TeXFiles/020_Einfuehrung}
	\input{TeXFiles/030_StandDerTechnik}
	\input{TeXFiles/040_EntwickelteMethode} 
	\input{TeXFiles/041_EvaluationDerMethode}
	\input{TeXFiles/042_Ergebnisse}
	\input{TeXFiles/100_Zusammenfassung}

	\begin{appendix}
		\input{TeXFiles/110_Anhang}
	\end{appendix}

	\clearpage

	
	%\printglossary[type=acronym,title=Abbreviations]
	%\addcontentsline{toc}{section}{Abbreviations} 
	%\addcontentsline{toc}{chapter*}{Verzeichnis: Akronyme} 
	\clearpage

	%Falls man die Überschrift des Literaturverzeichnisses aendern moechte, geht das durch Verwendung der folgenden Zeile:
	\renewcommand*{\refname}{Literaturverzeichnis}

	%\bibliographystyle{plain} % Nummern in eckigen Klammern
	%%\bibliographystyle{alpha} % Anfangsbuchstaben Erstautor und Jahr

	% Wenn man folgenden Stil verwenden will, dann muss
	% \usepackage{harvard} vor \begin{document} aktiviert werden:
	%\bibliographystyle{agsm} % (Autoren in runden Klammern)
	%\newpage
	\clearpage
	\phantomsection % Da sonst falsche Verlinkung im Inhaltsverzeichnis
	\printbibliography[heading=bibintoc]    % Ohne Kapitelnummer /-buchstabe
	
	%\printbibliography[heading=bibnumbered]    % Mit Kapitelnummer /-buchstabe
	
	\input{TeXFiles/120_Declaration}
\end{document}

%% End of File